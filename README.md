# ğŸ¤– OBSID Decant Manager + Automatizare Oblio

PlatformÄƒ web profesionalÄƒ pentru procesarea comenzilor de decanturi parfumuri **cu automatizare completÄƒ pentru crearea bonurilor de producÈ›ie Ã®n Oblio**.

![OBSID Logo](https://gomagcdn.ro/domains3/obsid.ro/files/company/parfumuri-arabesti8220.svg)

---

## âš¡ FUNCÈšIONALITATE PRINCIPALÄ‚: AUTOMATIZARE OBLIO

### ğŸ¯ Ce face?

AplicaÈ›ia **creeazÄƒ automat bonuri de producÈ›ie Ã®n Oblio**, deschizÃ¢nd **tab-uri multiple Ã®n paralel** pentru procesare rapidÄƒ:

1. âœ… **Upload ONE-TIME**: ÃncarcÄƒ Excel o singurÄƒ datÄƒ
2. âœ… **Procesare AutomatÄƒ**: Extrage SKU-uri È™i cantitÄƒÈ›i
3. âœ… **Paralel Processing**: Deschide 5 tab-uri simultan (configurabil)
4. âœ… **Zero Input Manual**: Tampermonkey completeazÄƒ totul automat
5. âœ… **Auto-Close**: Tab-urile se Ã®nchid singure cÃ¢nd e gata

### ğŸš€ Rezultat

**Economie de timp:** De la 2-3 ore de muncÄƒ manualÄƒ â†’ **sub 2 minute automat**!

---

## ğŸŒŸ Caracteristici Complete

### Tab 1: Raport ProducÈ›ie Decanturi
- âœ… **Upload Excel** - ÃncarcÄƒ fiÈ™iere cu comenzi direct din browser
- âœ… **Procesare AutomatÄƒ** - Exclude automat comenzile anulate
- âœ… **Extragere SKU** - DetecteazÄƒ SKU-uri din coloana "Atribute"
- âœ… **Raport ProducÈ›ie** - Vizualizare clarÄƒ cu SKU, cantitÄƒÈ›i, bucÄƒÈ›i
- âœ… **Grupare InteligentÄƒ** - Organizat pe parfum È™i cantitate (3ml, 5ml, 10ml)
- âœ… **Export Excel** - DescarcÄƒ raportul pentru arhivare
- âœ… **Sumar Global** - Statistici complete per parfum

### Tab 2: Bonuri de ProducÈ›ie (AUTOMAT)
- âœ… **Auto-Populate** - Se completeazÄƒ automat din datele Tab 1 (un singur upload!)
- âœ… **Agregare SKU** - Grupare inteligentÄƒ pe SKU cu cantitÄƒÈ›i totale
- âœ… **Sortare Prioritate** - Cele mai solicitate produse primele
- âœ… **Copiere RapidÄƒ** - Buton pentru copiere toate SKU-urile
- âœ… **ğŸ¤– AUTOMATIZARE OBLIO** - Buton pentru procesare automatÄƒ Ã®n batch-uri

### Sistem Automatizare (COMPLET)
- âœ… **Tampermonkey Integration** - Script pentru automatizare browser
- âœ… **Batch Processing** - 5 tab-uri paralele cu delay-uri configurabile
- âœ… **Progress Indicator** - Vizualizare Ã®n timp real a procesÄƒrii
- âœ… **Session Persistence** - FoloseÈ™te sesiunea Oblio existentÄƒ (fÄƒrÄƒ re-login)
- âœ… **Auto-Fill Forms** - CompleteazÄƒ SKU, selecteazÄƒ din autocomplete, introduce cantitate
- âœ… **Auto-Save & Close** - SalveazÄƒ bonuri È™i Ã®nchide tab-uri automat

### Help System Integrat
- âœ… **Modal InstrucÈ›iuni** - Buton "â“ Cum funcÈ›ioneazÄƒ?" Ã®n interfaÈ›Äƒ
- âœ… **Ghid Instalare** - Link-uri directe cÄƒtre Tampermonkey pentru Edge/Chrome
- âœ… **Troubleshooting** - RezolvÄƒri pentru probleme comune
- âœ… **DocumentaÈ›ie CompletÄƒ** - Markdown files pentru referinÈ›Äƒ offline

### Design & UX
- âœ… **Design Profesional** - TemÄƒ gri/negru/alb cu logo OBSID
- âœ… **Responsive** - FuncÈ›ioneazÄƒ pe desktop, tabletÄƒ È™i mobile
- âœ… **Tab Interface** - Navigare simplÄƒ Ã®ntre funcÈ›ionalitÄƒÈ›i
- âœ… **Visual Feedback** - Loading spinners, alerts, progress indicators
- âœ… **HTTPS Securizat** - SSL automat prin Coolify

---

## ğŸš€ Demo

**Live:** [https://decant.obsid.ro](https://decant.obsid.ro)

---

## ğŸ“– DocumentaÈ›ie

### ğŸ“š Ghiduri de Utilizare

| FiÈ™ier | Descriere |
|--------|-----------|
| **QUICK_START.md** | Ãncepe Ã®n 3 minute - ghid rapid |
| **INSTALARE_TAMPERMONKEY.md** | Ghid complet de instalare È™i utilizare (120+ linii) |
| **DEPLOYMENT.md** | Ghid deployment Coolify cu troubleshooting |
| **README_AUTOMATIZARE.md** | DocumentaÈ›ie tehnicÄƒ despre automatizare |

### ğŸ¯ Workflow Complet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ÃncarcÄƒ Excel Ã®n Tab 1                  â”‚
â”‚     â†’ ProceseazÄƒ comenzi                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Tab 2 se completeazÄƒ AUTOMAT            â”‚
â”‚     â†’ VerificÄƒ SKU-uri È™i cantitÄƒÈ›i         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Click "ğŸ¤– START AUTOMATIZARE OBLIO"     â”‚
â”‚     â†’ ConfirmÄƒ Ã®n popup                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Browser deschide tab-uri Ã®n batch-uri:  â”‚
â”‚     â†’ Batch 1: 5 tab-uri (paralel)          â”‚
â”‚     â†’ AÈ™teptare 8 secunde                   â”‚
â”‚     â†’ Batch 2: urmÄƒtoarele 5 tab-uri       â”‚
â”‚     â†’ ... continuÄƒ pÃ¢nÄƒ la final            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Tampermonkey Ã®n fiecare tab:            â”‚
â”‚     âœ… CompleteazÄƒ SKU                      â”‚
â”‚     âœ… SelecteazÄƒ din autocomplete          â”‚
â”‚     âœ… Introduce cantitate                  â”‚
â”‚     âœ… SalveazÄƒ bonul                       â”‚
â”‚     âœ… Ãnchide tab-ul                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. GATA! Toate bonurile create! ğŸ‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Tehnologii

### Backend
- **Python 3.11** - Runtime
- **Flask 3.0+** - Web framework
- **Pandas 2.0+** - Excel processing
- **OpenPyXL** - Excel read/write

### Frontend
- **HTML5** - Structure
- **CSS3** - Styling (custom, no frameworks)
- **JavaScript (Vanilla)** - Logic È™i interactivitate
- **Tampermonkey** - Browser automation

### Deployment
- **Docker** - Containerization
- **Coolify** - PaaS deployment
- **Nginx** - Reverse proxy (via Coolify)
- **Ubuntu 20.04+** - Server OS

---

## ğŸ—ï¸ Structura Proiect

```
pregatire_decanturi/
â”œâ”€â”€ ğŸ“„ Dockerfile                      # Container configuration
â”œâ”€â”€ ğŸ“„ requirements.txt                # Python dependencies
â”œâ”€â”€ ğŸ“„ app.py                          # Flask application (backend)
â”‚
â”œâ”€â”€ ğŸ“ templates/
â”‚   â””â”€â”€ index.html                     # Frontend UI (2 tabs + modal)
â”‚
â”œâ”€â”€ ğŸ“ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css                  # Styling
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js                    # Frontend logic + automation
â”‚
â”œâ”€â”€ ğŸ“„ tampermonkey_oblio_auto.js      # Tampermonkey script pentru Oblio
â”‚
â”œâ”€â”€ ğŸ“ DocumentaÈ›ie/
â”‚   â”œâ”€â”€ README.md                      # Acest fiÈ™ier
â”‚   â”œâ”€â”€ QUICK_START.md                 # Ghid rapid 3 minute
â”‚   â”œâ”€â”€ INSTALARE_TAMPERMONKEY.md      # Ghid complet instalare
â”‚   â”œâ”€â”€ DEPLOYMENT.md                  # Ghid deployment Coolify
â”‚   â””â”€â”€ README_AUTOMATIZARE.md         # DocumentaÈ›ie tehnicÄƒ
â”‚
â”œâ”€â”€ ğŸ“ uploads/                        # Excel-uri Ã®ncÄƒrcate (temporar)
â””â”€â”€ ğŸ“ exports/                        # Excel-uri exportate (temporar)
```

---

## ğŸ¯ Instalare È™i Utilizare

### 1ï¸âƒ£ Instalare AplicaÈ›ie (O DATÄ‚)

AplicaÈ›ia este deja deployed la **https://decant.obsid.ro** via Coolify.

**Pentru development local:**
```bash
git clone <repo-url>
cd pregatire_decanturi
pip install -r requirements.txt
python app.py
# AcceseazÄƒ: http://localhost:5000
```

### 2ï¸âƒ£ Instalare Tampermonkey (O DATÄ‚)

**Microsoft Edge:**
1. https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd
2. Click "ObÈ›ine" â†’ "AdaugÄƒ extensie"

**Google Chrome:**
1. https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo
2. Click "Add to Chrome"

### 3ï¸âƒ£ Instalare Script OBSID (O DATÄ‚)

1. Click pe iconiÈ›a Tampermonkey â†’ "Dashboard"
2. Click pe "+" (script nou)
3. CopiazÄƒ conÈ›inutul din `tampermonkey_oblio_auto.js`
4. LipeÈ™te Ã®n editor È™i SalveazÄƒ (Ctrl+S)

### 4ï¸âƒ£ Utilizare ZilnicÄƒ

1. LogheazÄƒ-te Ã®n Oblio (o datÄƒ pe sesiune)
2. Deschide https://decant.obsid.ro
3. ÃncarcÄƒ Excel Ã®n Tab 1 â†’ ProceseazÄƒ
4. Tab 2 se completeazÄƒ automat
5. Click "ğŸ¤– START AUTOMATIZARE OBLIO"
6. â˜• RelaxeazÄƒ-te - bonurile se creeazÄƒ singure!

**CiteÈ™te:** `QUICK_START.md` pentru ghid detaliat

---

## ğŸ”§ Configurare AvansatÄƒ

### Ajustare PerformanÈ›Äƒ

EditeazÄƒ `static/js/main.js` (linia ~520):

```javascript
const BATCH_SIZE = 5;              // 3-10 (numÄƒr tab-uri paralele)
const DELAY_BETWEEN_TABS = 500;    // ms (Ã®ntre tab-uri Ã®n acelaÈ™i batch)
const DELAY_BETWEEN_BATCHES = 8000; // ms (Ã®ntre batch-uri)
```

**RecomandÄƒri:**
- **Calculator rapid + internet bun:** BATCH_SIZE = 10, DELAY = 5000
- **Balansat (RECOMANDAT):** BATCH_SIZE = 5, DELAY = 8000
- **Conservator:** BATCH_SIZE = 3, DELAY = 10000

### Ajustare Timeout Tampermonkey

EditeazÄƒ `tampermonkey_oblio_auto.js`:

```javascript
function waitForElement(selector, timeout = 10000) {
    // SchimbÄƒ 10000 la 15000 pentru timeout mai lung
}
```

---

## ğŸ”’ Securitate

### AplicaÈ›ie Web
- âœ… File type validation (doar .xlsx/.xls)
- âœ… Max upload size: 16MB
- âœ… HTTPS encryption
- âœ… Security headers (CSP, HSTS)
- âœ… Input sanitization
- âœ… Temporary file cleanup

### Tampermonkey Script
- âœ… RuleazÄƒ doar pe domeniul Oblio (`@match https://www.oblio.eu/stock/production/*`)
- âœ… Nu cere/trimite parole (foloseÈ™te sesiunea browser existentÄƒ)
- âœ… Nu acceseazÄƒ alte site-uri
- âœ… Open source - cod vizibil È™i auditabil

---

## ğŸ› Troubleshooting

### âŒ Tab-urile se deschid dar nu fac nimic

**SoluÈ›ie:** VerificÄƒ cÄƒ eÈ™ti logat Ã®n Oblio È™i cÄƒ Tampermonkey script este activ (icon verde).

### âŒ "Element not found" Ã®n console

**SoluÈ›ie:** ReÃ®mprospÄƒteazÄƒ pagina (Ctrl+F5) sau verificÄƒ cÄƒ Oblio nu a schimbat interfaÈ›a.

### âŒ Browser-ul se blocheazÄƒ

**SoluÈ›ie:** MicÈ™oreazÄƒ `BATCH_SIZE` la 3 Ã®n `main.js`.

### âŒ SKU nu apare Ã®n Tab 1

**SoluÈ›ie:** Hard refresh (Ctrl+Shift+R) sau clear cache.

**DocumentaÈ›ie completÄƒ:** Vezi `INSTALARE_TAMPERMONKEY.md` â†’ secÈ›iunea "Troubleshooting"

---

## ğŸ“Š PerformanÈ›Äƒ

### Timpi EstimaÈ›i

| Bonuri | Mod Manual | Mod Automat | Economie |
|--------|-----------|-------------|----------|
| 10     | ~30 min   | ~25 sec     | **98%** âš¡ |
| 25     | ~1.5 ore  | ~1 min      | **98%** âš¡ |
| 50     | ~3 ore    | ~2.5 min    | **98%** âš¡ |
| 100    | ~6 ore    | ~5 min      | **98%** âš¡ |

**Formula:**
```
Timp automat = (NumÄƒr batch-uri Ã— 8s) + (NumÄƒr bonuri Ã— 2s)
```

---

## ğŸ“ Link-uri Utile

### OBSID
- **Site Principal:** https://www.obsid.ro
- **Dashboard:** https://www.obsid.ro/gomag
- **AplicaÈ›ie Decanturi:** https://decant.obsid.ro

### External
- **Oblio (sistem producÈ›ie):** https://www.oblio.eu
- **Tampermonkey Edge:** https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd
- **Tampermonkey Chrome:** https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo

---

## ğŸš€ Deployment

### Coolify (RecomandatÄƒ)

AplicaÈ›ia este configuratÄƒ pentru auto-deploy din Git:

1. Push modificÄƒri Ã®n GitHub
2. Coolify detecteazÄƒ automat È™i face redeploy
3. VerificÄƒ logs pentru succes

**Detalii complete:** Vezi `DEPLOYMENT.md`

### Docker Manual

```bash
docker build -t obsid-decant .
docker run -d -p 5000:5000 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/exports:/app/exports \
  obsid-decant
```

---

## ğŸ¯ Roadmap Viitor

Posibile Ã®mbunÄƒtÄƒÈ›iri:

- [ ] Suport pentru multiple formate Excel (CSV, XLSX variations)
- [ ] Dashboard statistici procesÄƒri (cÃ¢te bonuri create, timp economisit)
- [ ] Integrare directÄƒ API Oblio (fÄƒrÄƒ Tampermonkey)
- [ ] Export PDF cu rapoarte
- [ ] Autentificare utilizatori (multi-tenant)
- [ ] Istoric procesÄƒri cu undo/redo
- [ ] Mobile app (React Native)

---

## ğŸ“„ LicenÈ›Äƒ

Â© 2025 OBSID - Parfumuri ArabeÈ™ti Premium. Toate drepturile rezervate.

---

## ğŸ™ MulÈ›umiri

**Dezvoltat cu â¤ï¸ È™i â˜• pentru OBSID**

AceastÄƒ aplicaÈ›ie economiseÈ™te **sute de ore de muncÄƒ** pe an, permiÈ›Ã¢nd echipei OBSID sÄƒ se concentreze pe ceea ce conteazÄƒ cu adevÄƒrat: **parfumuri de calitate premium**.

---

## ğŸ“ Suport

Pentru probleme tehnice:
1. CiteÈ™te documentaÈ›ia relevantÄƒ (`INSTALARE_TAMPERMONKEY.md`, `DEPLOYMENT.md`)
2. VerificÄƒ Console browser (F12) pentru erori
3. TesteazÄƒ local pentru izolarea problemei
4. ContacteazÄƒ echipa OBSID pentru suport suplimentar

**Happy automating! ğŸ¤–âœ¨**
