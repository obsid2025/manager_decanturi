# ğŸ¤– OBSID Decant Manager + Automatizare Oblio

PlatformÄƒ web profesionalÄƒ pentru procesarea comenzilor de decanturi parfumuri **cu automatizare completÄƒ pentru crearea bonurilor de producÈ›ie Ã®n Oblio**.

![OBSID Logo](https://gomagcdn.ro/domains3/obsid.ro/files/company/parfumuri-arabesti8220.svg)

---

## âš¡ FUNCÈšIONALITATE PRINCIPALÄ‚: AUTOMATIZARE OBLIO

### ğŸ¯ Ce face?

AplicaÈ›ia **creeazÄƒ automat bonuri de producÈ›ie Ã®n Oblio** folosind **Python Selenium WebDriver** pentru control complet al browser-ului:

1. âœ… **Upload ONE-TIME**: ÃncarcÄƒ Excel o singurÄƒ datÄƒ
2. âœ… **Procesare AutomatÄƒ**: Extrage SKU-uri È™i cantitÄƒÈ›i
3. âœ… **Selenium Automation**: Control complet browser Chrome
4. âœ… **Zero Input Manual**: Toate cÃ¢mpurile completate automat
5. âœ… **Session Persistence**: FoloseÈ™te sesiunea Oblio existentÄƒ

### ğŸš€ Rezultat

**Economie de timp:** De la 2-3 ore de muncÄƒ manualÄƒ â†’ **sub 5 minute automat**!

### ğŸ”„ Tehnologie FolositÄƒ

**Selenium WebDriver + Chrome** (Metoda NouÄƒ - RECOMANDATÄ‚)
- âœ… Control complet al browser-ului
- âœ… FÄƒrÄƒ limitÄƒri de securitate browser
- âœ… Logging detaliat È™i error handling
- âœ… Screenshots automate la erori
- âœ… Reutilizare sesiune Chrome existentÄƒ

---

## ğŸŒŸ Caracteristici Complete

### Tab 1: Raport ProducÈ›ie Decanturi
- âœ… **Upload Excel** - ÃncarcÄƒ fiÈ™iere cu comenzi direct din browser
- âœ… **Procesare AutomatÄƒ** - Exclude automat comenzile anulate
- âœ… **Extragere SKU** - DetecteazÄƒ SKU-uri din coloana "Atribute"
- âœ… **Raport ProducÈ›ie** - Vizualizare clarÄƒ cu SKU, cantitÄƒÈ›i, bucÄƒÈ›i
- âœ… **Grupare InteligentÄƒ** - Organizat pe parfum È™i cantitate (3ml, 5ml, 10ml)
- âœ… **Export Excel** - DescarcÄƒ raportul pentru arhivare
- âœ… **Sumar Global** - Statistici complete per parfum

### Tab 2: Bonuri de ProducÈ›ie (AUTOMAT)
- âœ… **Auto-Populate** - Se completeazÄƒ automat din datele Tab 1 (un singur upload!)
- âœ… **Agregare SKU** - Grupare inteligentÄƒ pe SKU cu cantitÄƒÈ›i totale
- âœ… **Sortare Prioritate** - Cele mai solicitate produse primele
- âœ… **Copiere RapidÄƒ** - Buton pentru copiere toate SKU-urile
- âœ… **ğŸ¤– AUTOMATIZARE SELENIUM** - Buton pentru procesare automatÄƒ completÄƒ

### Sistem Automatizare Selenium (COMPLET)
- âœ… **Chrome WebDriver Control** - Control complet al browser-ului Chrome
- âœ… **Sequential Processing** - Procesare stabilÄƒ È™i fiabilÄƒ bon-cu-bon
- âœ… **Real-Time Logging** - Log detaliat Ã®n `automatizare_oblio.log`
- âœ… **Session Persistence** - FoloseÈ™te sesiunea Oblio existentÄƒ (fÄƒrÄƒ re-login)
- âœ… **Auto-Fill Forms** - CompleteazÄƒ SKU character-by-character pentru autocomplete
- âœ… **jQuery UI Handling** - Selectare automatÄƒ din dropdown autocomplete
- âœ… **Error Screenshots** - CaptureazÄƒ screenshot-uri automat la erori
- âœ… **Statistics Tracking** - Raport detaliat: succese/eÈ™ecuri/erori

### Help System Integrat
- âœ… **Modal InstrucÈ›iuni** - Buton "â“ Cum funcÈ›ioneazÄƒ?" Ã®n interfaÈ›Äƒ
- âœ… **Ghid Selenium** - DocumentaÈ›ie completÄƒ instalare È™i utilizare
- âœ… **Troubleshooting** - RezolvÄƒri pentru probleme comune
- âœ… **DocumentaÈ›ie CompletÄƒ** - `SELENIUM_SETUP.md` pentru referinÈ›Äƒ offline

### Design & UX
- âœ… **Design Profesional** - TemÄƒ gri/negru/alb cu logo OBSID
- âœ… **Responsive** - FuncÈ›ioneazÄƒ pe desktop, tabletÄƒ È™i mobile
- âœ… **Tab Interface** - Navigare simplÄƒ Ã®ntre funcÈ›ionalitÄƒÈ›i
- âœ… **Visual Feedback** - Loading spinners, alerts, progress indicators
- âœ… **HTTPS Securizat** - SSL automat prin Coolify

---

## ğŸš€ Demo

**Live:** [https://decant.obsid.ro](https://decant.obsid.ro)

---

## ğŸ“– DocumentaÈ›ie

### ğŸ“š Ghiduri de Utilizare

| FiÈ™ier | Descriere |
|--------|-----------|
| **SELENIUM_SETUP.md** | Ghid complet instalare È™i utilizare Selenium (PRINCIPAL) |
| **QUICK_START.md** | Ãncepe Ã®n 3 minute - ghid rapid |
| **DEPLOYMENT.md** | Ghid deployment Coolify cu troubleshooting |
| **README_AUTOMATIZARE.md** | DocumentaÈ›ie tehnicÄƒ despre automatizare (versiune veche Edge) |

### ğŸ¯ Workflow Complet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ÃncarcÄƒ Excel Ã®n Tab 1                  â”‚
â”‚     â†’ ProceseazÄƒ comenzi                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Tab 2 se completeazÄƒ AUTOMAT            â”‚
â”‚     â†’ VerificÄƒ SKU-uri È™i cantitÄƒÈ›i         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Click "ğŸ¤– START AUTOMATIZARE (SELENIUM)"â”‚
â”‚     â†’ ConfirmÄƒ Ã®n popup                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Backend Flask primeÈ™te request          â”‚
â”‚     â†’ PorneÈ™te script Selenium Python       â”‚
â”‚     â†’ Chrome se deschide automat            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Pentru fiecare bon (secvenÈ›ial):        â”‚
â”‚     âœ… AcceseazÄƒ pagina de producÈ›ie        â”‚
â”‚     âœ… CompleteazÄƒ SKU (char-by-char)       â”‚
â”‚     âœ… AÈ™teaptÄƒ autocomplete jQuery UI      â”‚
â”‚     âœ… SelecteazÄƒ primul rezultat           â”‚
â”‚     âœ… Introduce cantitate                  â”‚
â”‚     âœ… SalveazÄƒ bonul                       â”‚
â”‚     âœ… VerificÄƒ succes                      â”‚
â”‚     ğŸ“ Log detaliat la fiecare pas          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Raport final Ã®n browser + log file:     â”‚
â”‚     â†’ X bonuri create cu succes âœ…          â”‚
â”‚     â†’ Y bonuri eÈ™uate (cu detalii) âŒ       â”‚
â”‚     â†’ Screenshot-uri la erori ğŸ“¸            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Tehnologii

### Backend
- **Python 3.11** - Runtime
- **Flask 3.0+** - Web framework
- **Pandas 2.0+** - Excel processing
- **OpenPyXL** - Excel read/write
- **Selenium 4.x** - Browser automation
- **ChromeDriver** - Chrome WebDriver pentru Selenium

### Frontend
- **HTML5** - Structure
- **CSS3** - Styling (custom, no frameworks)
- **JavaScript (Vanilla)** - Logic È™i interactivitate

### Deployment
- **Docker** - Containerization
- **Coolify** - PaaS deployment
- **Nginx** - Reverse proxy (via Coolify)
- **Ubuntu 20.04+** - Server OS

---

## ğŸ—ï¸ Structura Proiect

```
pregatire_decanturi/
â”œâ”€â”€ ğŸ“„ Dockerfile                           # Container configuration
â”œâ”€â”€ ğŸ“„ requirements.txt                     # Python dependencies
â”œâ”€â”€ ğŸ“„ app.py                               # Flask application (backend)
â”œâ”€â”€ ğŸ“„ automatizare_oblio_selenium.py       # â­ Script Selenium (PRINCIPAL)
â”‚
â”œâ”€â”€ ğŸ“ templates/
â”‚   â””â”€â”€ index.html                          # Frontend UI (2 tabs + modal)
â”‚
â”œâ”€â”€ ğŸ“ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css                       # Styling
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js                         # Frontend logic + automation
â”‚
â”œâ”€â”€ ğŸ“ DocumentaÈ›ie/
â”‚   â”œâ”€â”€ README.md                           # Acest fiÈ™ier
â”‚   â”œâ”€â”€ SELENIUM_SETUP.md                   # â­ Ghid complet Selenium
â”‚   â”œâ”€â”€ QUICK_START.md                      # Ghid rapid 3 minute
â”‚   â”œâ”€â”€ DEPLOYMENT.md                       # Ghid deployment Coolify
â”‚   â””â”€â”€ README_AUTOMATIZARE.md              # DocumentaÈ›ie tehnicÄƒ (veche)
â”‚
â”œâ”€â”€ ğŸ“ uploads/                             # Excel-uri Ã®ncÄƒrcate (temporar)
â”œâ”€â”€ ğŸ“ exports/                             # Excel-uri exportate (temporar)
â””â”€â”€ ğŸ“„ automatizare_oblio.log               # Log-uri Selenium (generat)
```

---

## ğŸ¯ Instalare È™i Utilizare

### 1ï¸âƒ£ Instalare AplicaÈ›ie (O DATÄ‚)

AplicaÈ›ia este deja deployed la **https://decant.obsid.ro** via Coolify.

**Pentru development local:**
```bash
git clone <repo-url>
cd pregatire_decanturi
pip install -r requirements.txt
python app.py
# AcceseazÄƒ: http://localhost:5000
```

### 2ï¸âƒ£ Instalare ChromeDriver (O DATÄ‚)

**Metoda AutomatÄƒ (RecomandatÄƒ):**
```bash
pip install webdriver-manager
```

**Metoda ManualÄƒ:**
1. VerificÄƒ versiunea Chrome: `chrome://settings/help`
2. DescarcÄƒ ChromeDriver corespunzÄƒtor: https://googlechromelabs.github.io/chrome-for-testing/
3. AdaugÄƒ Ã®n PATH sau copiazÄƒ Ã®n `C:\Windows\System32\`

**Verificare:**
```bash
chromedriver --version
```

### 3ï¸âƒ£ Utilizare ZilnicÄƒ

1. **LogheazÄƒ-te Ã®n Oblio** (o datÄƒ pe sesiune Ã®n Chrome)
2. Deschide **https://decant.obsid.ro**
3. ÃncarcÄƒ Excel Ã®n Tab 1 â†’ ProceseazÄƒ
4. Tab 2 se completeazÄƒ automat
5. Click **"ğŸ¤– START AUTOMATIZARE (SELENIUM)"**
6. â˜• RelaxeazÄƒ-te - bonurile se creeazÄƒ singure!
7. VerificÄƒ log-ul Ã®n `automatizare_oblio.log`

**CiteÈ™te:** `SELENIUM_SETUP.md` pentru ghid complet È™i troubleshooting

---

## ğŸ”§ Configurare AvansatÄƒ

### Ajustare PerformanÈ›Äƒ Selenium

EditeazÄƒ `automatizare_oblio_selenium.py`:

**1. Viteza de tastare (linia 186):**
```python
self.type_slowly(pp_name_input, sku, delay=0.08)
# Mai rapid: delay=0.05
# Mai lent (pentru conexiuni slabe): delay=0.15
```

**2. Timeout-uri (liniile 96, 117, 177):**
```python
def wait_for_element(self, by, selector, timeout=15):
    # CreÈ™te pentru conexiuni slabe: timeout=20
    # Scade pentru procesare rapidÄƒ: timeout=10
```

**3. PauzÄƒ Ã®ntre bonuri (linia 359):**
```python
time.sleep(2)  # Recomandare: 1-3 secunde
```

### Mod Headless (fÄƒrÄƒ GUI)

Pentru server sau background processing:

```python
automation = OblioAutomation(
    use_existing_profile=True,
    headless=True  # RuleazÄƒ fÄƒrÄƒ fereastrÄƒ vizibilÄƒ
)
```

âš ï¸ **AtenÈ›ie:** Ãn headless mode nu poÈ›i vedea ce se Ã®ntÃ¢mplÄƒ!

---

## ğŸ”’ Securitate

### AplicaÈ›ie Web
- âœ… File type validation (doar .xlsx/.xls)
- âœ… Max upload size: 16MB
- âœ… HTTPS encryption
- âœ… Security headers (CSP, HSTS)
- âœ… Input sanitization
- âœ… Temporary file cleanup

### Script Selenium
- âœ… FoloseÈ™te sesiunea Chrome existentÄƒ (nu solicitÄƒ parole)
- âœ… Nu salveazÄƒ credenÈ›iale Ã®n cod
- âœ… Logging detaliat pentru audit
- âœ… Screenshot-uri la erori (pentru debugging)
- âœ… RuleazÄƒ doar la cerere (nu automat)
- âœ… Open source - cod vizibil È™i auditabil

---

## ğŸ› Troubleshooting

### âŒ "ChromeDriver nu a fost gÄƒsit"

**SoluÈ›ie:**
```bash
pip install webdriver-manager
# SAU descarcÄƒ manual È™i adaugÄƒ Ã®n PATH
```

### âŒ "Chrome failed to start"

**SoluÈ›ie:** VerificÄƒ path-ul cÄƒtre profilul Chrome (linia 68 Ã®n `automatizare_oblio_selenium.py`):
```python
user_data_dir = r"C:\Users\TauUsername\AppData\Local\Google\Chrome\User Data"
```

### âŒ "Element #pp_name nu a fost gÄƒsit"

**SoluÈ›ie:**
1. VerificÄƒ cÄƒ eÈ™ti logat Ã®n Oblio
2. VerificÄƒ `automatizare_oblio.log` pentru detalii
3. CreÈ™te timeout-ul (linia 177)

### âŒ "Produsul cu SKU 'XXX' nu a fost selectat"

**SoluÈ›ie:**
1. VerificÄƒ cÄƒ SKU-ul existÄƒ Ã®n Oblio
2. CreÈ™te delay-ul de tastare (linia 186): `delay=0.15`
3. VerificÄƒ autocomplete Ã®n browser manual

### âŒ SKU nu apare Ã®n Tab 1

**SoluÈ›ie:** Hard refresh (Ctrl+Shift+R) sau clear cache.

**DocumentaÈ›ie completÄƒ:** Vezi `SELENIUM_SETUP.md` â†’ secÈ›iunea "Troubleshooting" (30+ soluÈ›ii)

---

## ğŸ“Š PerformanÈ›Äƒ

### Timpi EstimaÈ›i (Selenium)

| Bonuri | Mod Manual | Mod Automat Selenium | Economie |
|--------|-----------|----------------------|----------|
| 10     | ~30 min   | ~3 min               | **90%** âš¡ |
| 25     | ~1.5 ore  | ~7 min               | **92%** âš¡ |
| 50     | ~3 ore    | ~15 min              | **92%** âš¡ |
| 100    | ~6 ore    | ~30 min              | **92%** âš¡ |

**Formula:**
```
Timp automat = NumÄƒr bonuri Ã— ~15-20 secunde per bon
```

**Factori de influenÈ›Äƒ:**
- Viteza conexiunii internet
- PerformanÈ›a calculatorului
- Delay-urile configurate Ã®n script
- Timp rÄƒspuns server Oblio

---

## ğŸ“ Link-uri Utile

### OBSID
- **Site Principal:** https://www.obsid.ro
- **Dashboard:** https://www.obsid.ro/gomag
- **AplicaÈ›ie Decanturi:** https://decant.obsid.ro

### External
- **Oblio (sistem producÈ›ie):** https://www.oblio.eu
- **ChromeDriver Downloads:** https://googlechromelabs.github.io/chrome-for-testing/
- **Selenium Documentation:** https://www.selenium.dev/documentation/

---

## ğŸš€ Deployment

### Coolify (RecomandatÄƒ)

AplicaÈ›ia este configuratÄƒ pentru auto-deploy din Git:

1. Push modificÄƒri Ã®n GitHub
2. Coolify detecteazÄƒ automat È™i face redeploy
3. VerificÄƒ logs pentru succes

**Detalii complete:** Vezi `DEPLOYMENT.md`

### Docker Manual

```bash
docker build -t obsid-decant .
docker run -d -p 5000:5000 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/exports:/app/exports \
  obsid-decant
```

---

## ğŸ¯ Roadmap Viitor

Posibile Ã®mbunÄƒtÄƒÈ›iri:

- [x] ~~Integrare directÄƒ automatizare (fÄƒrÄƒ Tampermonkey)~~ âœ… **COMPLETAT - Selenium**
- [ ] Suport pentru multiple formate Excel (CSV, XLSX variations)
- [ ] Dashboard statistici procesÄƒri (cÃ¢te bonuri create, timp economisit)
- [ ] Integrare directÄƒ API Oblio (fÄƒrÄƒ UI automation)
- [ ] Export PDF cu rapoarte
- [ ] Autentificare utilizatori (multi-tenant)
- [ ] Istoric procesÄƒri cu undo/redo
- [ ] Retry automat pentru bonurile eÈ™uate
- [ ] NotificÄƒri email la finalizare
- [ ] Mobile app (React Native)

---

## ğŸ“„ LicenÈ›Äƒ

Â© 2025 OBSID - Parfumuri ArabeÈ™ti Premium. Toate drepturile rezervate.

---

## ğŸ™ MulÈ›umiri

**Dezvoltat cu â¤ï¸ È™i â˜• pentru OBSID**

AceastÄƒ aplicaÈ›ie economiseÈ™te **sute de ore de muncÄƒ** pe an, permiÈ›Ã¢nd echipei OBSID sÄƒ se concentreze pe ceea ce conteazÄƒ cu adevÄƒrat: **parfumuri de calitate premium**.

---

## ğŸ“ Suport

Pentru probleme tehnice:
1. CiteÈ™te documentaÈ›ia relevantÄƒ (`SELENIUM_SETUP.md`, `DEPLOYMENT.md`)
2. VerificÄƒ `automatizare_oblio.log` pentru erori
3. VerificÄƒ Console browser (F12) pentru erori frontend
4. TesteazÄƒ local pentru izolarea problemei
5. ContacteazÄƒ echipa OBSID pentru suport suplimentar

**Happy automating! ğŸ¤–âœ¨**
